### 系统的拓扑图结构如下

![](/assets/artifact.png)

#### 1. 客户端层

Web 层主要包括用户通过Internet 到达网关这一层,具体方式为B端客户使用 小程序,手机 H5 或者浏览器 访问公司服,其中 需要的技术和机器结构为 CDN\(提供图片和部分URL 的加速服务\) Gateway 公司内采用Nginx

#### 2. 应用服务层

本层职责主要是顶层Controller, 负责校验参数,路由具体服务,组合Service 层和第三方系统Wrapper 的返回值.以及特定应用的接口主要包含四个部分

1. H5 是大B等客户的下单渠道
2. 小程序端C端或小B客户的下单渠道
3. Admin 管理类目,产品,价格,等后台UI
4. Batch 不提供给客户服务,用于项目中的批处理以及solr 搜索库的定期全量更新

#### 3. 微服务层

微服务层是独立部署的业务逻辑执行层, 主要包含商品,订单,类目等实体的管理,以及第三方系统\(cms,wms,oms,vms\)返回值错误封装

* 账户子系统

  * 管理大B和小B客户,拥有客户类型等可扩展的客户信息
  * 客户可以挂载权限信息,角色信息
  * 客户可以添加附加属性

* 订单子系统

  * 支付数据管理
  * 订单流程管理
  * 

* 产品子系统

  * 提供产品数据增删改查,搜索,基础属性视图,详情视图等基础功能

  * 提供产品活动管理数据的维护

  * 价格规则维护

* vms

  * 供应商管理

  * 采购单管理

* 分销子系统

  * 分销首页管理

  * 小程序首页管理

### 4. 存储层

存储层提供了系统的数据存储\(mongo\),客户端登录用户追踪,缓存处理\(redis\),搜索服务\(solr\)等处理dao,  mongodb 采用最新版,可以使用事务,目前为了维护和避免跨库join 暂时不分库就是单一mongo. 微服务的模块划分也是按照粗粒度和事务完整性角度来实现

### 系统框架选择

* 后端主要框架就是spring cloud的一系列产品微服务产品, 配合shiro\(权限管理\), solr\(搜索服务\) mongo4\(存储服务\) rabbitmq\(系统间通信\) 搭建基本的框架.,部署方式采用单jar包+java service wrapper 的形式. 具体的

* 后端框架基本上就是vue 或者react 有成熟组件库的admin, 



